{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\AllBook\\index.vue?vue&type=style&index=0&id=0b706b23&scoped=true&lang=scss","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\AllBook\\index.vue","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1749726397077},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1749726394932},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1749726394615},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1749726393347},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1749726393897}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5BbGxCb29rewogIHBhZGRpbmc6IDAgMjBweCAzMHB4IDIwcHg7CiAgaGVpZ2h0OiAxMDAlOwogIC5lbC1mb3JtewogICAgLmVsLWZvcm0taXRlbXsKICAgICAgLmVsLWlucHV0ewogICAgICAgIHdpZHRoOiAyMDBweDsKICAgICAgfQogICAgfQogIH0KICAuZWwtdGFibGV7CiAgICAub3BlcmF0aW9uewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgPip7CiAgICAgICAgbWFyZ2luOiAwIDJweCAxMHB4IDJweDsKICAgICAgfQogICAgfQogIH0KICAuZWwtcGFnaW5hdGlvbnsKICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICA6OnYtZGVlcHsKICAgICAgLmVsLXBhZ2VyewogICAgICAgICY+bGk6bm90KC5pcy1hY3RpdmUpewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7CiAgICAgICAgfQogICAgICB9CiAgICAgICY+LmJ0bi1wcmV2LCY+LmJ0bi1uZXh0ewogICAgICAgICY6bm90KFtkaXNhYmxlZF0pewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIC5ib3Jyb3dEaWFsb2c6OnYtZGVlcHsKICAgICY+ZGl2ewogICAgICBmb250LXdlaWdodDogYm9sZDsKICAgIH0KICAgICY+ZGl2Om5vdCg6bGFzdC1jaGlsZCl7CiAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\AllBook\\index.vue"],"names":[],"mappings":"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","file":"D:/桌面/前端交互/final/LibraryManagementSystem-master/Library-vue/src/views/admin/AllBook/index.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"AllBook\">\n    <el-form :inline=\"true\" :model=\"queryForm\" label-position=\"left\">\n      <el-form-item label=\"ISBN\">\n        <el-input v-model=\"queryForm.isbn\" placeholder=\"按ISBN号筛选\" clearable></el-input>\n      </el-form-item>\n      <el-form-item label=\"标题\">\n        <el-input v-model=\"queryForm.name\" placeholder=\"按标题筛选\" clearable ></el-input>\n      </el-form-item>\n      <el-form-item label=\"作者\">\n        <el-input v-model=\"queryForm.author\" placeholder=\"按作者筛选\" clearable ></el-input>\n      </el-form-item>\n      <el-form-item label=\"分类\">\n        <el-select v-model=\"queryForm.typeId\" placeholder=\"选择图书分类\" clearable>\n          <el-option\n              v-for=\"type in bookTypeList\" :key=\"type.id\"\n              :label=\"type.name\" :value=\"type.id\">\n          </el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"排序\">\n        <el-select v-model=\"queryForm.sort\" placeholder=\"排序规则\" clearable>\n          <el-option label=\"按照出版日期排序\" value=\"1\"></el-option>\n          <el-option label=\"按照更新时间排序\" value=\"2\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"queryBook\">查询</el-button>\n      </el-form-item>\n    </el-form>\n    <el-table :data=\"bookList\" border stripe highlight-current-row ref=\"tableRef\">\n      <el-table-column label=\"序号\" fixed=\"left\" align=\"center\" type=\"index\" :index=\"indexMethod\"></el-table-column>\n      <el-table-column fixed=\"left\" label=\"分类\" prop=\"typeName\"></el-table-column>\n      <el-table-column fixed=\"left\" label=\"ISBN\" prop=\"isbn\"></el-table-column>\n      <el-table-column fixed=\"left\" label=\"封面\" align=\"center\">\n        <template #default=\"{row}\">\n          <el-image :src=\"row.coverImg\">\n            <template #error>\n              <el-icon><icon-picture /></el-icon>\n            </template>\n          </el-image>\n        </template>\n      </el-table-column>\n      <el-table-column fixed=\"left\" label=\"名称\" prop=\"name\"></el-table-column>\n      <el-table-column label=\"作者\" prop=\"author\"></el-table-column>\n      <el-table-column label=\"出版社\" prop=\"press\"></el-table-column>\n      <el-table-column label=\"定价\" prop=\"price\"></el-table-column>\n      <el-table-column label=\"出版日期\" prop=\"publishTime\"></el-table-column>\n      <el-table-column label=\"数量\" prop=\"stockNum\" align=\"center\"></el-table-column>\n      <el-table-column label=\"操作\" align=\"center\" fixed=\"right\" width=\"170px\">\n        <template #default=\"{row}\">\n          <div class=\"operation\">\n            <el-button @click=\"getBookDetail(row.id)\">查看图书</el-button>\n            <el-button @click=\"updateBook(row.id)\">修改图书基本信息</el-button>\n            <el-button @click=\"openAddBookDialog(row.id)\">添加图书</el-button>\n            <el-button @click=\"openOutBookDialog(row.id,row.stockNum)\">图书出库</el-button>\n          </div>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n        background layout=\"total, prev, pager, next\"\n        :total=\"pagination.total\"\n        :page-size=\"pagination.limit\"\n        v-model:current-page=\"pagination.current\"\n        @current-change=\"pageChange\"/>\n\n    <el-dialog\n        v-model=\"addBookInfo.dialog\" title=\"添加图书库存\"\n        :draggable=\"true\" destroy-on-close\n        @closed=\"addBookDialogClosed\">\n      <template #footer>\n        <el-button @click=\"addBookInfo.dialog = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"addBookStock\">确定</el-button>\n      </template>\n      添加库存的数量：<el-input-number v-model=\"addBookInfo.addNum\" :min=\"1\"></el-input-number>\n    </el-dialog>\n\n    <el-dialog\n        v-model=\"outBookInfo.dialog\" title=\"图书出库\"\n        :draggable=\"true\" destroy-on-close\n        @closed=\"outBookDialogClosed\">\n      <template #footer>\n        <el-button @click=\"outBookInfo.dialog = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"outBook\">确定</el-button>\n      </template>\n      图书出库的数量：<el-input-number v-model=\"outBookInfo.num\" :min=\"1\" :max=\"outBookInfo.maxNum\"></el-input-number>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport {useRouter} from 'vue-router'\nimport {onMounted, shallowReactive, shallowRef, onBeforeMount} from 'vue'\nimport {getPageBookInfoApi,getBookTypeApi} from \"@/api/borrower\";\nimport {addBookStockApi,bookOutStockApi} from \"@/api/admin\";\nimport { Picture as IconPicture } from '@element-plus/icons-vue'\nimport {ElMessage, ElLoading} from 'element-plus'\n\nexport default {\n  name: \"AllBook\",\n  components:{\n    IconPicture\n  },\n  setup(){\n    // 存储图书信息的数组\n    const bookList = shallowReactive([])\n    // 表单对象，用于显示加载动画\n    const tableRef = shallowRef()\n    // 获取图书信息\n    function getPageBookInfo(){\n      // 先清空数据\n      bookList.splice(0,bookList.length)\n      const loadingInstance = ElLoading.service({\n        target: tableRef.value.$el,\n      })\n      getPageBookInfoApi(pagination.current,pagination.limit,queryForm)\n          .then(res=>{\n            if(Array.isArray(res.data.records)){\n              bookList.push(...res.data.records)\n              pagination.total = res.data.total\n            }\n          })\n          .finally(()=>{\n            loadingInstance.close()\n          })\n    }\n    onMounted(()=>{\n      getPageBookInfo()\n    })\n\n    // 分页数据\n    const pagination = shallowReactive({\n      current: 1,\n      limit: 15,\n      total: 0\n    })\n    // 页码改变的事件\n    function pageChange(){\n      getPageBookInfo()\n    }\n\n\n    // 筛选条件的表单\n    const queryForm = shallowReactive({\n      isbn: '',\n      author: '',\n      name: '',\n      typeId: '',\n      sort: ''\n    })\n    // 存储图书分类的数组\n    const bookTypeList = shallowReactive([])\n    function getBookType(){\n      getBookTypeApi()\n          .then(res=>{\n            if(Array.isArray(res.data.types)){\n              bookTypeList.splice(0,bookTypeList.length,...res.data.types)\n            }\n          })\n    }\n    // 提交表单查询图书信息\n    function queryBook(){\n      if(pagination.current !== 1) {\n        pagination.current = 1\n      }\n      getPageBookInfo()\n    }\n    onBeforeMount(()=>{\n      getBookType()\n    })\n    // 表格索引的方法\n    function indexMethod(index){\n      return index + 1 + (pagination.current-1) * pagination.limit\n    }\n\n    const router = useRouter()\n    // 查看书籍详细信息\n    function getBookDetail(bookId){\n      router.push({\n        name: 'BookDetail',\n        params:{\n          bookId\n        }\n      })\n    }\n    // 修改图书基本信息\n    function updateBook(bookId){\n      router.push({\n        name: 'UpdateBookInfo',\n        params:{\n          bookId\n        }\n      })\n    }\n\n    // 添加库存的功能\n    const addBookInfo = shallowReactive({\n      dialog: false,\n      bookId: null,\n      addNum: null\n    })\n    function openAddBookDialog(bookId){\n      addBookInfo.bookId = bookId\n      addBookInfo.addNum = 1\n      addBookInfo.dialog = true\n    }\n    function addBookDialogClosed(){\n      addBookInfo.addNum = null\n      addBookInfo.dialog = false\n      addBookInfo.bookId = null\n    }\n    // 添加库存\n    function addBookStock(){\n      addBookStockApi(addBookInfo.bookId,addBookInfo.addNum)\n        .then(res=>{\n          ElMessage({type: 'success',duration: 5000,showClose: true,message: res.message})\n          // 刷新列表\n          getPageBookInfo()\n          // 关闭对话框\n          addBookInfo.dialog = false\n        })\n    }\n\n\n    // 图书出库功能\n    const outBookInfo = shallowReactive({\n      dialog: false,\n      bookId: null,\n      num: null,\n      maxNum: null\n    })\n    function openOutBookDialog(bookId,maxNum){\n      outBookInfo.bookId = bookId\n      outBookInfo.num = 1\n      outBookInfo.maxNum = maxNum\n      outBookInfo.dialog = true\n    }\n    function outBookDialogClosed(){\n      outBookInfo.dialog = false\n      outBookInfo.bookId = null\n      outBookInfo.num = null\n      outBookInfo.maxNum = null\n    }\n    // 图书出库接口\n    function outBook(){\n      bookOutStockApi(outBookInfo.bookId,outBookInfo.num)\n        .then(res=>{\n          ElMessage({type: 'success',duration: 5000,showClose: true,message: res.message})\n          // 刷新列表\n          getPageBookInfo()\n          // 关闭对话框\n          outBookInfo.dialog = false\n        })\n    }\n\n\n    return {\n      tableRef, bookList,\n      pagination,pageChange,indexMethod,\n      queryForm,bookTypeList,queryBook,\n      getBookDetail,updateBook,\n      addBookInfo,openAddBookDialog,addBookDialogClosed,addBookStock,\n      outBookInfo,openOutBookDialog,outBookDialogClosed,outBook\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.AllBook{\n  padding: 0 20px 30px 20px;\n  height: 100%;\n  .el-form{\n    .el-form-item{\n      .el-input{\n        width: 200px;\n      }\n    }\n  }\n  .el-table{\n    .operation{\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      >*{\n        margin: 0 2px 10px 2px;\n      }\n    }\n  }\n  .el-pagination{\n    margin-top: 10px;\n    ::v-deep{\n      .el-pager{\n        &>li:not(.is-active){\n          background-color: white;\n        }\n      }\n      &>.btn-prev,&>.btn-next{\n        &:not([disabled]){\n          background-color: white;\n        }\n      }\n    }\n  }\n  .borrowDialog::v-deep{\n    &>div{\n      font-weight: bold;\n    }\n    &>div:not(:last-child){\n      margin-bottom: 10px;\n    }\n  }\n}\n</style>\n"]}]}