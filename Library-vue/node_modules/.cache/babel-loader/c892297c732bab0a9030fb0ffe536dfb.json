{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\store\\useDynamicRouteStore.js","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\store\\useDynamicRouteStore.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\babel.config.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js","mtime":1749726396308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkQ6L1x1Njg0Q1x1OTc2Mi9cdTUyNERcdTdBRUZcdTRFQTRcdTRFOTIvZmluYWwvTGlicmFyeU1hbmFnZW1lbnRTeXN0ZW0tbWFzdGVyL0xpYnJhcnktdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovXHU2ODRDXHU5NzYyL1x1NTI0RFx1N0FFRlx1NEVBNFx1NEU5Mi9maW5hbC9MaWJyYXJ5TWFuYWdlbWVudFN5c3RlbS1tYXN0ZXIvTGlicmFyeS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgZGVmaW5lU3RvcmUgfSBmcm9tICJwaW5pYSI7CmltcG9ydCB7IGNvbnN0YW50Um91dGVyLCBhc3luY1JvdXRlciB9IGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IHJvdXRlciBmcm9tICJAL3JvdXRlciI7Ci8qKgogKiBVc2UgbWV0YS5yb2xlIHRvIGRldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBwZXJtaXNzaW9uCiAqIEBwYXJhbSByb2xlcwogKiBAcGFyYW0gcm91dGUKICovCgpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHJvbGVzLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucm9sZXMpIHsKICAgIHJldHVybiByb2xlcy5zb21lKGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnJvbGVzLmluY2x1ZGVzKHJvbGUpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQovKioKICogRmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyBieSByZWN1cnNpb24KICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcwogKiBAcGFyYW0gcm9sZXMKICovCgoKZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVzKHJvdXRlcywgcm9sZXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gX29iamVjdFNwcmVhZCh7fSwgcm91dGUpOwoKICAgIGlmIChoYXNQZXJtaXNzaW9uKHJvbGVzLCB0bXApKSB7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcyh0bXAuY2hpbGRyZW4sIHJvbGVzKTsKICAgICAgfQoKICAgICAgcmVzLnB1c2godG1wKTsKICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CmV4cG9ydCB2YXIgdXNlRHluYW1pY1JvdXRpbmdTdG9yZSA9IGRlZmluZVN0b3JlKCdkeW5hbWljUm91dGVTdG9yZScsIHsKICBzdGF0ZTogZnVuY3Rpb24gc3RhdGUoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDlrZjlgqjnu4/ov4fmnYPpmZDov4fmu6TlkI7lsZXnpLrnmoTot6/nlLHooagKICAgICAgcm91dGVzOiBbXSwKICAgICAgLy8g5a2Y5YKo5bCG6KaB6KKr56e76Zmk55qE6Lev55Sx5a+56LGh77yMdnVlLXJvdXRlcjQueOenu+mZpOi3r+eUseeahOato+ehruWnv+WKv+aYr+S/neWtmHJvdXRlci5hZGRSb3V0ZSgp5pa55rOV55qE6L+U5Zue5YC8KOexu+Wei+S4uuWHveaVsCks54S25ZCO6LCD55So6L+U5Zue5YC8CiAgICAgIHdpbGxSZW1vdmVkUm91dGVzOiBbXQogICAgfTsKICB9LAogIGFjdGlvbnM6IHsKICAgIC8vIOagueaNruadg+mZkOeUn+aIkOWKqOaAgei3r+eUsQogICAgZ2VuZXJhdGVEeW5hbWljUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZUR5bmFtaWNSb3V0ZXMocm9sZXMpIHsKICAgICAgLy8g6L+H5ruk5Ye65YWB6K645re75Yqg55qE6Lev55Sx5a+56LGhCiAgICAgIHZhciBhY2Nlc3NSb3V0ZXMgPSBmaWx0ZXJBc3luY1JvdXRlcyhhc3luY1JvdXRlciwgcm9sZXMpOyAvLyDmnoTlu7rlrozmiJDnmoTot6/nlLHooagKCiAgICAgIHRoaXMucm91dGVzID0gY29uc3RhbnRSb3V0ZXIuY29uY2F0KGFjY2Vzc1JvdXRlcyk7IC8vIOa3u+WKoOWKqOaAgei3r+eUsQogICAgICAvLyDmt7vliqDkuYvliY3lhYjlsJ3or5XliqjmgIHot6/nlLEKCiAgICAgIHRoaXMucmVzZXREeW5hbWljUm91dGVzKCk7IC8vIHZ1ZS1yb3V0ZXI0LnjliqjmgIHmt7vliqDot6/nlLHnmoTmlrnms5UKCiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihhY2Nlc3NSb3V0ZXMpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcm91dGUgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIHZhciByZW1vdmVSb3V0ZSA9IHJvdXRlci5hZGRSb3V0ZShyb3V0ZSk7IC8vIOS/neWtmOW3sua3u+WKoOi3r+eUseeahOWbnuiwg++8jOWcqOWIoOmZpOeahOaXtuWAmeS8mueUqOWIsAoKICAgICAgICAgIHRoaXMud2lsbFJlbW92ZWRSb3V0ZXMucHVzaChyZW1vdmVSb3V0ZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDph43nva7liqjmgIHot6/nlLEKICAgIHJlc2V0RHluYW1pY1JvdXRlczogZnVuY3Rpb24gcmVzZXREeW5hbWljUm91dGVzKCkgewogICAgICAvLyDliKDpmaTliqjmgIHot6/nlLEKICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLndpbGxSZW1vdmVkUm91dGVzKSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByZW1vdmVSb3V0ZSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgIC8vIOiwg+eUqOaWueazleWIoOmZpOi3r+eUsQogICAgICAgICAgcmVtb3ZlUm91dGUoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICB9CiAgICB9CiAgfQp9KTs="},{"version":3,"names":["defineStore","constantRouter","asyncRouter","router","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","useDynamicRoutingStore","state","willRemovedRoutes","actions","generateDynamicRoutes","accessRoutes","concat","resetDynamicRoutes","removeRoute","addRoute"],"sources":["D:/桌面/前端交互/final/LibraryManagementSystem-master/Library-vue/src/store/useDynamicRouteStore.js"],"sourcesContent":["import {defineStore} from \"pinia\";\nimport {constantRouter,asyncRouter} from '@/router'\nimport router from \"@/router\";\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return roles.some(role => route.meta.roles.includes(role))\n  } else {\n    return true\n  }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n  const res = []\n\n  routes.forEach(route => {\n    const tmp = { ...route }\n    if (hasPermission(roles, tmp)) {\n      if (tmp.children) {\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\n      }\n      res.push(tmp)\n    }\n  })\n  return res\n}\n\nexport const useDynamicRoutingStore = defineStore('dynamicRouteStore',{\n  state: ()=>({\n    // 存储经过权限过滤后展示的路由表\n    routes: [],\n    // 存储将要被移除的路由对象，vue-router4.x移除路由的正确姿势是保存router.addRoute()方法的返回值(类型为函数),然后调用返回值\n    willRemovedRoutes: []\n  }),\n  actions:{\n    // 根据权限生成动态路由\n    generateDynamicRoutes(roles){\n      // 过滤出允许添加的路由对象\n      let accessRoutes = filterAsyncRoutes(asyncRouter,roles)\n      // 构建完成的路由表\n      this.routes = constantRouter.concat(accessRoutes)\n      // 添加动态路由\n      // 添加之前先尝试动态路由\n      this.resetDynamicRoutes()\n      // vue-router4.x动态添加路由的方法\n      for(let route of accessRoutes){\n        let removeRoute = router.addRoute(route)\n        // 保存已添加路由的回调，在删除的时候会用到\n        this.willRemovedRoutes.push(removeRoute)\n      }\n    },\n    // 重置动态路由\n    resetDynamicRoutes(){\n      // 删除动态路由\n      for(let removeRoute of this.willRemovedRoutes){\n        // 调用方法删除路由\n        removeRoute()\n      }\n    }\n  }\n})\n"],"mappings":";;;;;;;AAAA,SAAQA,WAAR,QAA0B,OAA1B;AACA,SAAQC,cAAR,EAAuBC,WAAvB,QAAyC,UAAzC;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAEA;AACA;AACA;AACA;AACA;;AACA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EAAqC;EACnC,IAAIA,KAAK,CAACC,IAAN,IAAcD,KAAK,CAACC,IAAN,CAAWF,KAA7B,EAAoC;IAClC,OAAOA,KAAK,CAACG,IAAN,CAAW,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAN,CAAWF,KAAX,CAAiBK,QAAjB,CAA0BD,IAA1B,CAAJ;IAAA,CAAf,CAAP;EACD,CAFD,MAEO;IACL,OAAO,IAAP;EACD;AACF;AAED;AACA;AACA;AACA;AACA;;;AACA,OAAO,SAASE,iBAAT,CAA2BC,MAA3B,EAAmCP,KAAnC,EAA0C;EAC/C,IAAMQ,GAAG,GAAG,EAAZ;EAEAD,MAAM,CAACE,OAAP,CAAe,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,qBAAQT,KAAR,CAAT;;IACA,IAAIF,aAAa,CAACC,KAAD,EAAQU,GAAR,CAAjB,EAA+B;MAC7B,IAAIA,GAAG,CAACC,QAAR,EAAkB;QAChBD,GAAG,CAACC,QAAJ,GAAeL,iBAAiB,CAACI,GAAG,CAACC,QAAL,EAAeX,KAAf,CAAhC;MACD;;MACDQ,GAAG,CAACI,IAAJ,CAASF,GAAT;IACD;EACF,CARD;EASA,OAAOF,GAAP;AACD;AAED,OAAO,IAAMK,sBAAsB,GAAGlB,WAAW,CAAC,mBAAD,EAAqB;EACpEmB,KAAK,EAAE;IAAA,OAAK;MACV;MACAP,MAAM,EAAE,EAFE;MAGV;MACAQ,iBAAiB,EAAE;IAJT,CAAL;EAAA,CAD6D;EAOpEC,OAAO,EAAC;IACN;IACAC,qBAFM,iCAEgBjB,KAFhB,EAEsB;MAC1B;MACA,IAAIkB,YAAY,GAAGZ,iBAAiB,CAACT,WAAD,EAAaG,KAAb,CAApC,CAF0B,CAG1B;;MACA,KAAKO,MAAL,GAAcX,cAAc,CAACuB,MAAf,CAAsBD,YAAtB,CAAd,CAJ0B,CAK1B;MACA;;MACA,KAAKE,kBAAL,GAP0B,CAQ1B;;MAR0B,2CASTF,YATS;MAAA;;MAAA;QAS1B,oDAA8B;UAAA,IAAtBjB,KAAsB;UAC5B,IAAIoB,WAAW,GAAGvB,MAAM,CAACwB,QAAP,CAAgBrB,KAAhB,CAAlB,CAD4B,CAE5B;;UACA,KAAKc,iBAAL,CAAuBH,IAAvB,CAA4BS,WAA5B;QACD;MAbyB;QAAA;MAAA;QAAA;MAAA;IAc3B,CAhBK;IAiBN;IACAD,kBAlBM,gCAkBc;MAClB;MADkB,4CAEK,KAAKL,iBAFV;MAAA;;MAAA;QAElB,uDAA8C;UAAA,IAAtCM,WAAsC;UAC5C;UACAA,WAAW;QACZ;MALiB;QAAA;MAAA;QAAA;MAAA;IAMnB;EAxBK;AAP4D,CAArB,CAA1C"}]}