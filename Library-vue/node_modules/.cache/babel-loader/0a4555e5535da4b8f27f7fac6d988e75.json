{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\BatchAddBook\\index.vue?vue&type=template&id=4eb88fe6&scoped=true","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\BatchAddBook\\index.vue","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1749726395074},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1749726393897},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\babel.config.js","mtime":1750002481133},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1749726395074},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1749726393897}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVzb2x2ZUNvbXBvbmVudCBhcyBfcmVzb2x2ZUNvbXBvbmVudCwgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCB3aXRoQ3R4IGFzIF93aXRoQ3R4LCBjcmVhdGVFbGVtZW50Vk5vZGUgYXMgX2NyZWF0ZUVsZW1lbnRWTm9kZSwgY3JlYXRlVGV4dFZOb2RlIGFzIF9jcmVhdGVUZXh0Vk5vZGUsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jaywgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aFNjb3BlSWQgPSBmdW5jdGlvbiBfd2l0aFNjb3BlSWQobikgewogIHJldHVybiBfcHVzaFNjb3BlSWQoImRhdGEtdi00ZWI4OGZlNiIpLCBuID0gbigpLCBfcG9wU2NvcGVJZCgpLCBuOwp9OwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAgY2xhc3M6ICJiYXRjaEFkZEJvb2siCn07Cgp2YXIgX2hvaXN0ZWRfMiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoZnVuY3Rpb24gKCkgewogIHJldHVybiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJlbC11cGxvYWRfX3RleHQiCiAgfSwgWy8qI19fUFVSRV9fKi9fY3JlYXRlVGV4dFZOb2RlKCIg5ouW5ou95paH5Lu25Yiw5q2k5aSEIOaIliAiKSwgLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImVtIiwgbnVsbCwgIueCueWHu+i/memHjOS4iuS8oCIpXSwgLTEKICAvKiBIT0lTVEVEICovCiAgKTsKfSk7Cgp2YXIgX2hvaXN0ZWRfMyA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoZnVuY3Rpb24gKCkgewogIHJldHVybiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJlbC11cGxvYWRfX3RpcCIsCiAgICBzdHlsZTogewogICAgICAiZm9udC1zaXplIjogIjE0cHgiCiAgICB9CiAgfSwgIiDlj6rlhYHorrjmjqXlj5cueGxz5ZKMLnhsc3jmlofku7bvvIzkuIDmrKHlj6rog73kuIrkvKAgMSDkuKrmlofku7YgIiwgLTEKICAvKiBIT0lTVEVEICovCiAgKTsKfSk7Cgp2YXIgX2hvaXN0ZWRfNCA9IC8qI19fUFVSRV9fKi9fY3JlYXRlVGV4dFZOb2RlKCLmibnph4/lr7zlhaUiKTsKCnZhciBfaG9pc3RlZF81ID0gLyojX19QVVJFX18qL19jcmVhdGVUZXh0Vk5vZGUoIuaooeadv+aWh+S7tuS4i+i9vSIpOwoKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgX2NvbXBvbmVudF9lbF9hbGVydCA9IF9yZXNvbHZlQ29tcG9uZW50KCJlbC1hbGVydCIpOwoKICB2YXIgX2NvbXBvbmVudF91cGxvYWRfZmlsbGVkID0gX3Jlc29sdmVDb21wb25lbnQoInVwbG9hZC1maWxsZWQiKTsKCiAgdmFyIF9jb21wb25lbnRfZWxfaWNvbiA9IF9yZXNvbHZlQ29tcG9uZW50KCJlbC1pY29uIik7CgogIHZhciBfY29tcG9uZW50X2VsX3VwbG9hZCA9IF9yZXNvbHZlQ29tcG9uZW50KCJlbC11cGxvYWQiKTsKCiAgdmFyIF9jb21wb25lbnRfZWxfYnV0dG9uID0gX3Jlc29sdmVDb21wb25lbnQoImVsLWJ1dHRvbiIpOwoKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfZWxfYWxlcnQsIHsKICAgIHR5cGU6ICJpbmZvIiwKICAgICJzaG93LWljb24iOiAiIiwKICAgIHRpdGxlOiAi6YCa6L+H5LiK5LygRXhjZWzmlofku7bmnaXmibnph4/lr7zlhaXlm77kuaYiLAogICAgY2xvc2FibGU6IGZhbHNlCiAgfSksIF9jcmVhdGVWTm9kZShfY29tcG9uZW50X2VsX3VwbG9hZCwgewogICAgcmVmOiAidXBsb2FkUmVmIiwKICAgIHN0eWxlOiB7CiAgICAgICJ3aWR0aCI6ICI1MDBweCIsCiAgICAgICJtYXJnaW4tdG9wIjogIjEwcHgiCiAgICB9LAogICAgZHJhZzogIiIsCiAgICBhY3Rpb246ICIiLAogICAgImF1dG8tdXBsb2FkIjogZmFsc2UsCiAgICBsaW1pdDogMSwKICAgIGFjY2VwdDogImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0LGFwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCIsCiAgICAib24tY2hhbmdlIjogJHNldHVwLmZpbGVDaGFuZ2UsCiAgICAib24tZXhjZWVkIjogJHNldHVwLmZpbGVFeGNlZWQsCiAgICAiYmVmb3JlLXJlbW92ZSI6ICRzZXR1cC5yZW1vdmVGaWxlCiAgfSwgewogICAgdGlwOiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbX2hvaXN0ZWRfM107CiAgICB9KSwKICAgIGRlZmF1bHQ6IF93aXRoQ3R4KGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9lbF9pY29uLCB7CiAgICAgICAgY2xhc3M6ICJlbC1pY29uLS11cGxvYWQiCiAgICAgIH0sIHsKICAgICAgICBkZWZhdWx0OiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW19jcmVhdGVWTm9kZShfY29tcG9uZW50X3VwbG9hZF9maWxsZWQpXTsKICAgICAgICB9KSwKICAgICAgICBfOiAxCiAgICAgICAgLyogU1RBQkxFICovCgogICAgICB9KSwgX2hvaXN0ZWRfMl07CiAgICB9KSwKICAgIF86IDEKICAgIC8qIFNUQUJMRSAqLwoKICB9LCA4CiAgLyogUFJPUFMgKi8KICAsIFsib24tY2hhbmdlIiwgIm9uLWV4Y2VlZCIsICJiZWZvcmUtcmVtb3ZlIl0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9lbF9idXR0b24sIHsKICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgIG9uQ2xpY2s6ICRzZXR1cC51cGxvYWRGaWxlCiAgfSwgewogICAgZGVmYXVsdDogX3dpdGhDdHgoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gW19ob2lzdGVkXzRdOwogICAgfSksCiAgICBfOiAxCiAgICAvKiBTVEFCTEUgKi8KCiAgfSwgOAogIC8qIFBST1BTICovCiAgLCBbIm9uQ2xpY2siXSksIF9jcmVhdGVWTm9kZShfY29tcG9uZW50X2VsX2J1dHRvbiwgewogICAgdHlwZTogImluZm8iLAogICAgb25DbGljazogJHNldHVwLmRvd25sb2FkVGVtcGxhdGUKICB9LCB7CiAgICBkZWZhdWx0OiBfd2l0aEN0eChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbX2hvaXN0ZWRfNV07CiAgICB9KSwKICAgIF86IDEKICAgIC8qIFNUQUJMRSAqLwoKICB9LCA4CiAgLyogUFJPUFMgKi8KICAsIFsib25DbGljayJdKV0pOwp9"},{"version":3,"mappings":";;;;;;;EACOA,KAAK,EAAC;;;;sBAWPC,oBAEM,KAFN,EAEM;IAFDD,KAAK,EAAC;EAEL,CAFN,EAA4B,+BAAC,cAAD,eAChBC,oBAAe,IAAf,EAAe,IAAf,EAAI,QAAJ,CADgB,CAA5B;;EAAA;;;;sBAIEA,oBAEM,KAFN,EAEM;IAFDD,KAAK,EAAC,gBAEL;IAFsBE,KAAuB,EAAvB;MAAA;IAAA;EAEtB,CAFN,EAAoD,kCAApD,EAEA;EAAA;EAFA;;;+CAK0C;;+CACG;;;;;;;;;;;;;uBArBnDC,oBAsBM,KAtBN,cAsBM,CArBJC,aAAwFC,mBAAxF,EAAwF;IAA9EC,IAAI,EAAC,MAAyE;IAAlE,eAAkE;IAAxDC,KAAK,EAAC,oBAAkD;IAA5BC,QAAQ,EAAE;EAAkB,CAAxF,CAqBI,EApBJJ,aAiBYK,oBAjBZ,EAiBY;IAhBRC,GAAG,EAAC,WAgBI;IAfRR,KAAsC,EAAtC;MAAA;MAAA;IAAA,CAeQ;IAdRS,IAAI,EAAJ,EAcQ;IAdHC,MAAM,EAAC,EAcJ;IAdQ,eAAa,KAcrB;IAd6BC,KAAK,EAAE,CAcpC;IAbRC,MAAM,EAAC,4FAaC;IAZP,aAAWC,iBAYJ;IAXP,aAAWA,iBAWJ;IAVP,iBAAeA;EAUR,CAjBZ;IAYaC,GAAG,WACZ;MAAA,OAEM,CAFNC,UAEM,CAFN;IAAA,CADY;sBAJd;MAAA,OAA4D,CAA5Db,aAA4Dc,kBAA5D,EAA4D;QAAnDlB,KAAK,EAAC;MAA6C,CAA5D,EAAgC;0BAAC;UAAA,OAAiB,CAAjBI,aAAiBe,wBAAjB,CAAiB,CAAjB;QAAA,EAAD;;;;MAAA,CAAhC,CAA4D,EAC5DC,UAD4D,CAA5D;IAAA;;;;GARF;;EAAA,8CAoBI,EAFJhB,aAA8DiB,oBAA9D,EAA8D;IAAnDf,IAAI,EAAC,SAA8C;IAAnCgB,OAAK,EAAEP;EAA4B,CAA9D;sBAA8C;MAAA,OAAI,YAAJ;IAAA;;;;GAA9C;;EAAA,cAEI,EADJX,aAAmEiB,oBAAnE,EAAmE;IAAxDf,IAAI,EAAC,MAAmD;IAA3CgB,OAAK,EAAEP;EAAoC,CAAnE;sBAAiD;MAAA,OAAM,YAAN;IAAA;;;;GAAjD;;EAAA,cACI,CAtBN","names":["class","_createElementVNode","style","_createElementBlock","_createVNode","_component_el_alert","type","title","closable","_component_el_upload","ref","drag","action","limit","accept","$setup","tip","_hoisted_3","_component_el_icon","_component_upload_filled","_hoisted_2","_component_el_button","onClick"],"sourceRoot":"","sources":["D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\admin\\BatchAddBook\\index.vue"],"sourcesContent":["<template>\n  <div class=\"batchAddBook\">\n    <el-alert type=\"info\" show-icon title=\"通过上传Excel文件来批量导入图书\" :closable=\"false\"></el-alert>\n    <el-upload\n        ref=\"uploadRef\"\n        style=\"width: 500px;margin-top: 10px;\"\n        drag action=\"\" :auto-upload=\"false\" :limit=\"1\"\n        accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\n        :on-change=\"fileChange\"\n        :on-exceed=\"fileExceed\"\n        :before-remove=\"removeFile\">\n      <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\n      <div class=\"el-upload__text\">\n        拖拽文件到此处 或 <em>点击这里上传</em>\n      </div>\n      <template #tip>\n        <div class=\"el-upload__tip\" style=\"font-size: 14px\">\n          只允许接受.xls和.xlsx文件，一次只能上传 1 个文件\n        </div>\n      </template>\n    </el-upload>\n    <el-button type=\"success\" @click=\"uploadFile\">批量导入</el-button>\n    <el-button type=\"info\" @click=\"downloadTemplate\">模板文件下载</el-button>\n  </div>\n</template>\n\n<script>\nimport {UploadFilled} from '@element-plus/icons-vue'\nimport {shallowRef} from \"vue\";\nimport {ElMessage,genFileId} from \"element-plus\";\nimport {batchAddBookApi} from \"@/api/admin\";\n\nexport default {\n  name: \"BatchAddBook\",\n  components:{\n    UploadFilled\n  },\n  setup(){\n    // 下载批量导入的模板文件\n    function downloadTemplate(){\n      let publicPath = process.env.BASE_URL\n      let link = document.createElement('a')\n      link.style.display = 'none'\n      link.href = `${publicPath}批量导入图书模板.xls`\n      console.log(link.href)\n      document.body.appendChild(link)\n      link.click()\n      link.remove()\n    }\n\n    // 上传组件\n    const uploadRef = shallowRef()\n    const currentFile = shallowRef(null)\n    // 文件是否合法\n    function isFileAllowed(file){\n      // 判断文件的类型是否正确\n      const allowType = ['xls','xlsx']\n      let suffix = file.name.substring(file.name.lastIndexOf('.') + 1).toLowerCase()\n      if(allowType.indexOf(suffix) === -1){\n        return false\n      }\n      // 判断大小是否合理 小于2M\n      const limitSize = 1024 * 1024 * 2\n      return file.size <= limitSize;\n    }\n    // 当文件状态改变的时候触发，例如添加文件\n    function fileChange(file){\n      if(!isFileAllowed(file)){\n        ElMessage({type: 'warning',message: '文件不符合要求',duration: 5000,showClose: true})\n        uploadRef.value.handleRemove(file)\n      }else{\n        // 记录当前文件\n        currentFile.value = file.raw\n      }\n    }\n    // 当文件超出限制的时候\n    function fileExceed(files){\n      // 取第一个文件\n      let file = files[0]\n      if(!isFileAllowed(file)){\n        ElMessage({type: 'warning',message: '文件不符合要求',duration: 5000,showClose: true})\n      }else{\n        // 清空列表\n        uploadRef.value.clearFiles()\n        file.uid = genFileId()\n        // 设置第一个文件\n        uploadRef.value.handleStart(file)\n        // 记录当前文件\n        currentFile.value = file\n      }\n    }\n    // 文件移除\n    function removeFile(){\n      currentFile.value = null\n    }\n    // 上传文件\n    function uploadFile(){\n      if(currentFile.value){\n        batchAddBookApi(currentFile.value)\n          .then(()=>{\n            ElMessage({type: 'success',message: '上传文件成功',duration: 5000,showClose: true})\n            uploadRef.value.clearFiles()\n          })\n      }else {\n        ElMessage({type: 'error',message: '请先上传文件',duration: 5000,showClose: true})\n      }\n    }\n    return {\n      downloadTemplate,\n      uploadRef,fileChange,fileExceed,currentFile,removeFile,uploadFile\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.batchAddBook{\n  padding: 20px 30px 30px 20px;\n}\n</style>\n"]}]}