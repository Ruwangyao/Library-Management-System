{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\store\\useUserInfoStore.js","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\store\\useUserInfoStore.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\babel.config.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js","mtime":1749726396308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L1x1Njg0Q1x1OTc2Mi9cdTUyNERcdTdBRUZcdTRFQTRcdTRFOTIvZmluYWwvTGlicmFyeU1hbmFnZW1lbnRTeXN0ZW0tbWFzdGVyL0xpYnJhcnktdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IHsgZGVmaW5lU3RvcmUgfSBmcm9tICJwaW5pYSI7CmltcG9ydCB7IHVzZUR5bmFtaWNSb3V0aW5nU3RvcmUgfSBmcm9tICJAL3N0b3JlL3VzZUR5bmFtaWNSb3V0ZVN0b3JlIjsKaW1wb3J0IHsgdXNlQXBwU2V0dGluZ1N0b3JlIH0gZnJvbSAiQC9zdG9yZS91c2VBcHBTZXR0aW5nU3RvcmUiOwppbXBvcnQgeyBnZXRVc2VySW5mb0FwaSB9IGZyb20gIkAvYXBpL3VzZXIiOwppbXBvcnQgeyByZW1vdmVUb2tlbiB9IGZyb20gIkAvdXRpbHMvYXV0aCI7CmltcG9ydCB7IGdldFVzZXJSZXNvdXJjZUFwaSB9IGZyb20gIkAvYXBpL2JvcnJvd2VyIjsgLy8g566h55CG5YWo5bGA55qE55So5oi35L+h5oGv5Y2z54q25oCBCgpleHBvcnQgdmFyIHVzZVVzZXJJbmZvU3RvcmUgPSBkZWZpbmVTdG9yZSgndXNlckluZm9TdG9yZScsIHsKICBzdGF0ZTogZnVuY3Rpb24gc3RhdGUoKSB7CiAgICByZXR1cm4gewogICAgICB1aWQ6ICcnLAogICAgICBuYW1lOiAnJywKICAgICAgZW1haWw6ICcnLAogICAgICBwZXJtaXNzaW9uczogW10sCiAgICAgIC8vIOeUqOaIt+eahOWAn+mYhei1hOa6kAogICAgICB1c2VyQm9va1Jlc291cmNlOiB7CiAgICAgICAgYm9ycm93ZWROdW06IG51bGwsCiAgICAgICAgYm9ycm93TWF4TnVtOiBudWxsCiAgICAgIH0KICAgIH07CiAgfSwKICBnZXR0ZXJzOiB7CiAgICAvLyDmmK/lkKblt7Lnu4/ojrflj5bkuobnlKjmiLfnmoTkv6Hmga8KICAgIGhhc0dldFVzZXJJbmZvOiBmdW5jdGlvbiBoYXNHZXRVc2VySW5mbyhzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudWlkICE9PSAnJyAmJiBzdGF0ZS5uYW1lICYmIHN0YXRlLmVtYWlsICYmIEFycmF5LmlzQXJyYXkoc3RhdGUucGVybWlzc2lvbnMpOwogICAgfSwKICAgIC8vIOaYr+WQpuiDveiOt+WPlueUqOaIt+i1hOa6kCzlj6rmnInnlKjmiLfmi6XmnInlm77kuabnmoTotYTmupDkv6Hmga8KICAgIGhhc1Jlc291cmNlOiBmdW5jdGlvbiBoYXNSZXNvdXJjZShzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUucGVybWlzc2lvbnMuaW5kZXhPZignYm9ycm93ZXInKSAhPT0gLTE7CiAgICB9LAogICAgYm9ycm93ZWROdW06IGZ1bmN0aW9uIGJvcnJvd2VkTnVtKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS51c2VyQm9va1Jlc291cmNlLmJvcnJvd2VkTnVtOwogICAgfSwKICAgIGJvcnJvd01heE51bTogZnVuY3Rpb24gYm9ycm93TWF4TnVtKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS51c2VyQm9va1Jlc291cmNlLmJvcnJvd01heE51bTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIGdldFVzZXJJbmZvOiBmdW5jdGlvbiBnZXRVc2VySW5mbygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlcywgRHluYW1pY1JvdXRpbmdTdG9yZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRVc2VySW5mb0FwaSgpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgX3RoaXMudWlkID0gcmVzLmRhdGEudXNlckluZm8uaWQ7CiAgICAgICAgICAgICAgICBfdGhpcy5uYW1lID0gcmVzLmRhdGEudXNlckluZm8udXNlcm5hbWU7CiAgICAgICAgICAgICAgICBfdGhpcy5lbWFpbCA9IHJlcy5kYXRhLnVzZXJJbmZvLmVtYWlsOwogICAgICAgICAgICAgICAgX3RoaXMucGVybWlzc2lvbnMgPSByZXMuZGF0YS51c2VySW5mby5wZXJtaXNzaW9uczsKICAgICAgICAgICAgICAgIER5bmFtaWNSb3V0aW5nU3RvcmUgPSB1c2VEeW5hbWljUm91dGluZ1N0b3JlKCk7IC8vIOagueaNruadg+mZkOeUn+aIkOWKqOaAgei3r+eUsQoKICAgICAgICAgICAgICAgIER5bmFtaWNSb3V0aW5nU3RvcmUuZ2VuZXJhdGVEeW5hbWljUm91dGVzKF90aGlzLnBlcm1pc3Npb25zKTsgLy8g5Yid5aeL5YyW55So5oi36LWE5rqQCgogICAgICAgICAgICAgICAgX3RoaXMuZ2V0VXNlclJlc291cmNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8g6YeN572u55So5oi35L+h5oGvCiAgICByZXNldFVzZXJJbmZvOiBmdW5jdGlvbiByZXNldFVzZXJJbmZvKCkgewogICAgICB2YXIgRHluYW1pY1JvdXRpbmdTdG9yZSA9IHVzZUR5bmFtaWNSb3V0aW5nU3RvcmUoKTsgLy8g5Yig6Zmk5Yqo5oCB5re75Yqg55qE6Lev55Sx5pWw5o2u77yI6YeN572udnVlLXJvdXRlcu+8iQoKICAgICAgRHluYW1pY1JvdXRpbmdTdG9yZS5yZXNldER5bmFtaWNSb3V0ZXMoKTsgLy8g6YeN572u5Yqo5oCB6Lev55Sx55qEc3RvcmXnmoTlgLwKCiAgICAgIER5bmFtaWNSb3V0aW5nU3RvcmUuJHJlc2V0KCk7CiAgICAgIHZhciBBcHBTZXR0aW5nU3RvcmUgPSB1c2VBcHBTZXR0aW5nU3RvcmUoKTsgLy8g6YeN572uQVBQ6K6+572uCgogICAgICBBcHBTZXR0aW5nU3RvcmUuJHJlc2V0KCk7IC8vIOa4hemZpHRva2VuCgogICAgICByZW1vdmVUb2tlbigpOyAvLyDph43nva7mnKxzdG9yZeeahOWAvAoKICAgICAgdGhpcy4kcmVzZXQoKTsKICAgIH0sCiAgICAvLyDojrflj5bnlKjmiLflv5fmhL8KICAgIGdldFVzZXJSZXNvdXJjZTogZnVuY3Rpb24gZ2V0VXNlclJlc291cmNlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghX3RoaXMyLmhhc1Jlc291cmNlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFVzZXJSZXNvdXJjZUFwaSgpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEucmVzb3VyY2UpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLnVzZXJCb29rUmVzb3VyY2UuYm9ycm93ZWROdW0gPSByZXMuZGF0YS5yZXNvdXJjZS5ib3Jyb3dlZE51bTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLnVzZXJCb29rUmVzb3VyY2UuYm9ycm93TWF4TnVtID0gcmVzLmRhdGEucmVzb3VyY2UuYm9ycm93TWF4TnVtOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn0pOw=="},{"version":3,"names":["defineStore","useDynamicRoutingStore","useAppSettingStore","getUserInfoApi","removeToken","getUserResourceApi","useUserInfoStore","state","uid","name","email","permissions","userBookResource","borrowedNum","borrowMaxNum","getters","hasGetUserInfo","Array","isArray","hasResource","indexOf","actions","getUserInfo","res","data","userInfo","id","username","DynamicRoutingStore","generateDynamicRoutes","getUserResource","resetUserInfo","resetDynamicRoutes","$reset","AppSettingStore","resource"],"sources":["D:/桌面/前端交互/final/LibraryManagementSystem-master/Library-vue/src/store/useUserInfoStore.js"],"sourcesContent":["import {defineStore} from \"pinia\";\nimport {useDynamicRoutingStore} from \"@/store/useDynamicRouteStore\";\nimport {useAppSettingStore} from \"@/store/useAppSettingStore\";\nimport {getUserInfoApi} from \"@/api/user\";\nimport {removeToken} from \"@/utils/auth\";\nimport {getUserResourceApi} from \"@/api/borrower\";\n\n// 管理全局的用户信息即状态\nexport const useUserInfoStore = defineStore('userInfoStore',{\n  state: ()=> ({\n    uid: '',\n    name: '',\n    email: '',\n    permissions: [],\n    // 用户的借阅资源\n    userBookResource:{\n      borrowedNum: null,\n      borrowMaxNum: null,\n    }\n  }),\n  getters:{\n    // 是否已经获取了用户的信息\n    hasGetUserInfo(state){\n      return state.uid !== '' && state.name && state.email && Array.isArray(state.permissions)\n    },\n    // 是否能获取用户资源,只有用户拥有图书的资源信息\n    hasResource(state){\n      return state.permissions.indexOf('borrower') !== -1\n    },\n    borrowedNum(state){\n      return state.userBookResource.borrowedNum\n    },\n    borrowMaxNum(state){\n      return state.userBookResource.borrowMaxNum\n    }\n  },\n  actions:{\n    async getUserInfo(){\n      // 获取用户信息\n      let res = await getUserInfoApi()\n      this.uid = res.data.userInfo.id\n      this.name = res.data.userInfo.username\n      this.email = res.data.userInfo.email\n      this.permissions  = res.data.userInfo.permissions\n\n      const DynamicRoutingStore = useDynamicRoutingStore()\n      // 根据权限生成动态路由\n      DynamicRoutingStore.generateDynamicRoutes(this.permissions)\n\n      // 初始化用户资源\n      this.getUserResource()\n    },\n    // 重置用户信息\n    resetUserInfo(){\n      const DynamicRoutingStore = useDynamicRoutingStore()\n      // 删除动态添加的路由数据（重置vue-router）\n      DynamicRoutingStore.resetDynamicRoutes()\n      // 重置动态路由的store的值\n      DynamicRoutingStore.$reset()\n\n      const AppSettingStore = useAppSettingStore()\n      // 重置APP设置\n      AppSettingStore.$reset()\n\n      // 清除token\n      removeToken()\n      // 重置本store的值\n      this.$reset()\n    },\n    // 获取用户志愿\n    async getUserResource(){\n      if(this.hasResource){\n        let res = await getUserResourceApi()\n        if(res.data.resource) {\n          this.userBookResource.borrowedNum = res.data.resource.borrowedNum\n          this.userBookResource.borrowMaxNum = res.data.resource.borrowMaxNum\n        }\n      }\n    }\n  }\n})\n"],"mappings":";;;AAAA,SAAQA,WAAR,QAA0B,OAA1B;AACA,SAAQC,sBAAR,QAAqC,8BAArC;AACA,SAAQC,kBAAR,QAAiC,4BAAjC;AACA,SAAQC,cAAR,QAA6B,YAA7B;AACA,SAAQC,WAAR,QAA0B,cAA1B;AACA,SAAQC,kBAAR,QAAiC,gBAAjC,C,CAEA;;AACA,OAAO,IAAMC,gBAAgB,GAAGN,WAAW,CAAC,eAAD,EAAiB;EAC1DO,KAAK,EAAE;IAAA,OAAM;MACXC,GAAG,EAAE,EADM;MAEXC,IAAI,EAAE,EAFK;MAGXC,KAAK,EAAE,EAHI;MAIXC,WAAW,EAAE,EAJF;MAKX;MACAC,gBAAgB,EAAC;QACfC,WAAW,EAAE,IADE;QAEfC,YAAY,EAAE;MAFC;IANN,CAAN;EAAA,CADmD;EAY1DC,OAAO,EAAC;IACN;IACAC,cAFM,0BAEST,KAFT,EAEe;MACnB,OAAOA,KAAK,CAACC,GAAN,KAAc,EAAd,IAAoBD,KAAK,CAACE,IAA1B,IAAkCF,KAAK,CAACG,KAAxC,IAAiDO,KAAK,CAACC,OAAN,CAAcX,KAAK,CAACI,WAApB,CAAxD;IACD,CAJK;IAKN;IACAQ,WANM,uBAMMZ,KANN,EAMY;MAChB,OAAOA,KAAK,CAACI,WAAN,CAAkBS,OAAlB,CAA0B,UAA1B,MAA0C,CAAC,CAAlD;IACD,CARK;IASNP,WATM,uBASMN,KATN,EASY;MAChB,OAAOA,KAAK,CAACK,gBAAN,CAAuBC,WAA9B;IACD,CAXK;IAYNC,YAZM,wBAYOP,KAZP,EAYa;MACjB,OAAOA,KAAK,CAACK,gBAAN,CAAuBE,YAA9B;IACD;EAdK,CAZkD;EA4B1DO,OAAO,EAAC;IACAC,WADA,yBACa;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OAEDnB,cAAc,EAFb;;cAAA;gBAEboB,GAFa;gBAGjB,KAAI,CAACf,GAAL,GAAWe,GAAG,CAACC,IAAJ,CAASC,QAAT,CAAkBC,EAA7B;gBACA,KAAI,CAACjB,IAAL,GAAYc,GAAG,CAACC,IAAJ,CAASC,QAAT,CAAkBE,QAA9B;gBACA,KAAI,CAACjB,KAAL,GAAaa,GAAG,CAACC,IAAJ,CAASC,QAAT,CAAkBf,KAA/B;gBACA,KAAI,CAACC,WAAL,GAAoBY,GAAG,CAACC,IAAJ,CAASC,QAAT,CAAkBd,WAAtC;gBAEMiB,mBARW,GAQW3B,sBAAsB,EARjC,EASjB;;gBACA2B,mBAAmB,CAACC,qBAApB,CAA0C,KAAI,CAAClB,WAA/C,EAViB,CAYjB;;gBACA,KAAI,CAACmB,eAAL;;cAbiB;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAclB,CAfK;IAgBN;IACAC,aAjBM,2BAiBS;MACb,IAAMH,mBAAmB,GAAG3B,sBAAsB,EAAlD,CADa,CAEb;;MACA2B,mBAAmB,CAACI,kBAApB,GAHa,CAIb;;MACAJ,mBAAmB,CAACK,MAApB;MAEA,IAAMC,eAAe,GAAGhC,kBAAkB,EAA1C,CAPa,CAQb;;MACAgC,eAAe,CAACD,MAAhB,GATa,CAWb;;MACA7B,WAAW,GAZE,CAab;;MACA,KAAK6B,MAAL;IACD,CAhCK;IAiCN;IACMH,eAlCA,6BAkCiB;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KAClB,MAAI,CAACX,WADa;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAEHd,kBAAkB,EAFf;;cAAA;gBAEfkB,GAFe;;gBAGnB,IAAGA,GAAG,CAACC,IAAJ,CAASW,QAAZ,EAAsB;kBACpB,MAAI,CAACvB,gBAAL,CAAsBC,WAAtB,GAAoCU,GAAG,CAACC,IAAJ,CAASW,QAAT,CAAkBtB,WAAtD;kBACA,MAAI,CAACD,gBAAL,CAAsBE,YAAtB,GAAqCS,GAAG,CAACC,IAAJ,CAASW,QAAT,CAAkBrB,YAAvD;gBACD;;cANkB;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAQtB;EA1CK;AA5BkD,CAAjB,CAApC"}]}