{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\borrower\\BookBorrowList\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\borrower\\BookBorrowList\\index.vue","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\babel.config.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1749726393897}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOi9cdTY4NENcdTk3NjIvXHU1MjREXHU3QUVGXHU0RUE0XHU0RTkyL2ZpbmFsL0xpYnJhcnlNYW5hZ2VtZW50U3lzdGVtLW1hc3Rlci9MaWJyYXJ5LXZ1ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgeyBtYXJrUmF3LCBvbkJlZm9yZU1vdW50LCBzaGFsbG93UmVhY3RpdmUsIHNoYWxsb3dSZWYgfSBmcm9tICJ2dWUiOwppbXBvcnQgeyBnZXRQYWdlQm9ycm93Qm9va0luZm9BcGksIHJldHVybkJvb2tBcGksIHJlbmV3Qm9va0FwaSB9IGZyb20gIkAvYXBpL2JvcnJvd2VyIjsKaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAidnVlLXJvdXRlciI7CmltcG9ydCB7IEVsTWVzc2FnZSB9IGZyb20gImVsZW1lbnQtcGx1cyI7CmltcG9ydCB7IHVzZVVzZXJJbmZvU3RvcmUgfSBmcm9tICJAL3N0b3JlL3VzZVVzZXJJbmZvU3RvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkJvb2tCb3Jyb3dMaXN0IiwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAvLyDliIbpobXkv6Hmga8KICAgIHZhciBwYWdpbmF0aW9uID0gc2hhbGxvd1JlYWN0aXZlKHsKICAgICAgY3VycmVudDogMSwKICAgICAgbGltaXQ6IDEwLAogICAgICB0b3RhbDogMAogICAgfSk7IC8vIOmhteWPt+aUueWPmAoKICAgIGZ1bmN0aW9uIHBhZ2VDaGFuZ2UoKSB7CiAgICAgIGdldFBhZ2VCb3Jyb3dCb29rSW5mbygpOwogICAgfSAvLyDlgJ/pmIXkv6Hmga8KCgogICAgdmFyIGJvcnJvd0Jvb2tMaXN0ID0gc2hhbGxvd1JlYWN0aXZlKFtdKTsKCiAgICBmdW5jdGlvbiBnZXRQYWdlQm9ycm93Qm9va0luZm8oKSB7CiAgICAgIC8vIOWFiOa4heepuuaVsOaNrgogICAgICBib3Jyb3dCb29rTGlzdC5zcGxpY2UoMCwgYm9ycm93Qm9va0xpc3QubGVuZ3RoKTsKICAgICAgZ2V0UGFnZUJvcnJvd0Jvb2tJbmZvQXBpKHBhZ2luYXRpb24uY3VycmVudCwgcGFnaW5hdGlvbi5saW1pdCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgYm9ycm93Qm9va0xpc3QucHVzaC5hcHBseShib3Jyb3dCb29rTGlzdCwgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLnJlY29yZHMpKTsKICAgICAgICBwYWdpbmF0aW9uLnRvdGFsID0gcmVzLmRhdGEudG90YWw7CiAgICAgIH0pOwogICAgfQoKICAgIG9uQmVmb3JlTW91bnQoZnVuY3Rpb24gKCkgewogICAgICBnZXRQYWdlQm9ycm93Qm9va0luZm8oKTsKICAgIH0pOyAvLyDmn6XnnIvlm77kuabor6bmg4UKCiAgICB2YXIgcm91dGVyID0gdXNlUm91dGVyKCk7CgogICAgZnVuY3Rpb24gZ2V0Qm9va0RldGFpbChib29rSWQpIHsKICAgICAgcm91dGVyLnB1c2goewogICAgICAgIHBhdGg6ICIvYm9va0RldGFpbC8iLmNvbmNhdChib29rSWQpCiAgICAgIH0pOwogICAgfSAvLyDlvZLov5jlm77kuaYKCgogICAgdmFyIFVzZXJJbmZvU3RvcmUgPSB1c2VVc2VySW5mb1N0b3JlKCk7CgogICAgZnVuY3Rpb24gcmV0dXJuQm9vayhib3Jyb3dJZCkgewogICAgICByZXR1cm5Cb29rQXBpKGJvcnJvd0lkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2UsCiAgICAgICAgICBkdXJhdGlvbjogNTAwMCwKICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGdldFBhZ2VCb3Jyb3dCb29rSW5mbygpOyAvLyDliLfmlrDnlKjmiLfotYTmupAKCiAgICAgICAgVXNlckluZm9TdG9yZS5nZXRVc2VyUmVzb3VyY2UoKTsKICAgICAgfSk7CiAgICB9IC8vIOe7reWAn+WbvuS5pgoKCiAgICB2YXIgcmVuZXdCb29rVmlzaWJsZSA9IHNoYWxsb3dSZWYoZmFsc2UpOwogICAgdmFyIHJlbmV3Qm9va0Zvcm0gPSBzaGFsbG93UmVhY3RpdmUoewogICAgICBib3Jyb3dJZDogbnVsbCwKICAgICAgcmVuZXdUaW1lOiBudWxsCiAgICB9KTsKCiAgICBmdW5jdGlvbiByZW5ld0Jvb2soKSB7CiAgICAgIHJlbmV3Qm9va0FwaShtYXJrUmF3KHJlbmV3Qm9va0Zvcm0pKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2UsCiAgICAgICAgICBkdXJhdGlvbjogNTAwMCwKICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGdldFBhZ2VCb3Jyb3dCb29rSW5mbygpOwogICAgICAgIHJlbmV3Qm9va1Zpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gb3BlblJlbmV3Qm9va0RpYWxvZyhib3Jyb3dJZCkgewogICAgICByZW5ld0Jvb2tGb3JtLmJvcnJvd0lkID0gYm9ycm93SWQ7CiAgICAgIHJlbmV3Qm9va0Zvcm0ucmVuZXdUaW1lID0gMzA7CiAgICAgIHJlbmV3Qm9va1Zpc2libGUudmFsdWUgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHBhZ2luYXRpb246IHBhZ2luYXRpb24sCiAgICAgIHBhZ2VDaGFuZ2U6IHBhZ2VDaGFuZ2UsCiAgICAgIGJvcnJvd0Jvb2tMaXN0OiBib3Jyb3dCb29rTGlzdCwKICAgICAgZ2V0Qm9va0RldGFpbDogZ2V0Qm9va0RldGFpbCwKICAgICAgcmV0dXJuQm9vazogcmV0dXJuQm9vaywKICAgICAgcmVuZXdCb29rVmlzaWJsZTogcmVuZXdCb29rVmlzaWJsZSwKICAgICAgcmVuZXdCb29rRm9ybTogcmVuZXdCb29rRm9ybSwKICAgICAgcmVuZXdCb29rOiByZW5ld0Jvb2ssCiAgICAgIG9wZW5SZW5ld0Jvb2tEaWFsb2c6IG9wZW5SZW5ld0Jvb2tEaWFsb2cKICAgIH07CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["markRaw","onBeforeMount","shallowReactive","shallowRef","getPageBorrowBookInfoApi","returnBookApi","renewBookApi","useRouter","ElMessage","useUserInfoStore","name","setup","pagination","current","limit","total","pageChange","getPageBorrowBookInfo","borrowBookList","splice","length","then","push","res","data","records","router","getBookDetail","bookId","path","UserInfoStore","returnBook","borrowId","type","message","duration","showClose","getUserResource","renewBookVisible","renewBookForm","renewTime","renewBook","value","openRenewBookDialog"],"sourceRoot":"","sources":["D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\views\\borrower\\BookBorrowList\\index.vue"],"sourcesContent":["<template>\n  <div class=\"bookBorrowList\">\n    <el-table :data=\"borrowBookList\" border stripe highlight-current-row table-layout=\"auto\">\n      <el-table-column label=\"序号\" fixed=\"left\" align=\"center\">\n        <template #default=\"{$index}\">{{$index + 1 + (pagination.current - 1) * pagination.limit}}</template>\n      </el-table-column>\n      <el-table-column label=\"订单号\" prop=\"id\" align=\"center\"></el-table-column>\n      <el-table-column label=\"图书名称\" prop=\"bookName\" align=\"center\"></el-table-column>\n      <el-table-column label=\"借阅时间\" prop=\"borrowBookDate\" align=\"center\"></el-table-column>\n      <el-table-column label=\"预期还书时间\" prop=\"returnBookDate\" align=\"center\"></el-table-column>\n      <el-table-column label=\"借阅时长(天)\" prop=\"borrowTime\" align=\"center\"></el-table-column>\n      <el-table-column label=\"订单完成时间\" align=\"center\">\n        <template #default=\"{row}\">\n          <div v-if=\"row.endDate\">{{row.endDate}}</div>\n          <div v-else>未完成</div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"订单状态\" prop=\"description\" align=\"center\"></el-table-column>\n      <el-table-column label=\"操作\" fixed=\"right\" align=\"center\" width=\"120px\">\n        <template #default=\"{row}\">\n          <div class=\"operation\">\n            <el-popconfirm v-if=\"row.status !== 2\" title=\"确认归还图书?\" @confirm=\"returnBook(row.id)\">\n              <template #reference><el-button>归还图书</el-button></template>\n            </el-popconfirm>\n            <el-button v-if=\"row.status === 0\" @click=\"openRenewBookDialog(row.id)\">续借</el-button>\n            <el-button @click=\"getBookDetail(row.bookId)\">查看图书</el-button>\n          </div>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n        background layout=\"total, prev, pager, next\"\n        :total=\"pagination.total\"\n        :page-size=\"pagination.limit\"\n        v-model:current-page=\"pagination.current\"\n        @current-change=\"pageChange\"/>\n\n    <el-dialog v-model=\"renewBookVisible\" title=\"续借图书\" :draggable=\"true\" destroy-on-close>\n      <template #footer>\n        <el-button @click=\"renewBookVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"renewBook\">确定</el-button>\n      </template>\n      <div class=\"renewDialog\">\n        <div>是否续借该图书?</div>\n        <div>\n          选择续借的天数：<el-input-number v-model=\"renewBookForm.renewTime\" :min=\"1\" :max=\"30\" size=\"small\" ></el-input-number>\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport {markRaw, onBeforeMount, shallowReactive, shallowRef} from \"vue\";\nimport {getPageBorrowBookInfoApi,returnBookApi,renewBookApi} from \"@/api/borrower\";\nimport {useRouter} from \"vue-router\";\nimport {ElMessage} from \"element-plus\";\nimport {useUserInfoStore} from \"@/store/useUserInfoStore\";\n\nexport default {\n  name: \"BookBorrowList\",\n  setup(){\n    // 分页信息\n    const pagination = shallowReactive({\n      current: 1,\n      limit: 10,\n      total: 0\n    })\n    // 页号改变\n    function pageChange(){\n      getPageBorrowBookInfo()\n    }\n\n    // 借阅信息\n    const borrowBookList = shallowReactive([])\n    function getPageBorrowBookInfo(){\n      // 先清空数据\n      borrowBookList.splice(0,borrowBookList.length)\n      getPageBorrowBookInfoApi(pagination.current,pagination.limit)\n        .then(res=>{\n          borrowBookList.push(...res.data.records)\n          pagination.total = res.data.total\n        })\n    }\n    onBeforeMount(()=>{\n      getPageBorrowBookInfo()\n    })\n\n    // 查看图书详情\n    const router = useRouter()\n    function getBookDetail(bookId){\n      router.push({path:`/bookDetail/${bookId}`})\n    }\n\n    // 归还图书\n    const UserInfoStore = useUserInfoStore()\n    function returnBook(borrowId){\n      returnBookApi(borrowId)\n        .then(res=>{\n          ElMessage({type: 'success',message: res.message,duration: 5000,showClose:true})\n          getPageBorrowBookInfo()\n          // 刷新用户资源\n          UserInfoStore.getUserResource()\n        })\n    }\n\n\n    // 续借图书\n    const renewBookVisible = shallowRef(false)\n    const renewBookForm = shallowReactive({\n      borrowId: null,\n      renewTime: null\n    })\n    function renewBook(){\n      renewBookApi(markRaw(renewBookForm))\n        .then(res=>{\n          ElMessage({type: 'success',message: res.message,duration: 5000,showClose:true})\n          getPageBorrowBookInfo()\n          renewBookVisible.value = false\n        })\n    }\n    function openRenewBookDialog(borrowId){\n      renewBookForm.borrowId = borrowId\n      renewBookForm.renewTime = 30\n      renewBookVisible.value = true\n    }\n\n    return {\n      pagination,pageChange,\n      borrowBookList,getBookDetail,returnBook,\n      renewBookVisible,renewBookForm,renewBook,openRenewBookDialog\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.bookBorrowList{\n  padding: 20px 30px 20px 30px;\n  .el-table{\n    .operation{\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      >*{\n        margin: 0 2px 10px 2px;\n      }\n    }\n  }\n  .el-pagination{\n    margin-top: 20px;\n  }\n  .renewDialog{\n    &>div{\n      font-weight: bold;\n    }\n    &>div:not(:last-child){\n      margin-bottom: 10px;\n    }\n  }\n}\n</style>\n"]}]}