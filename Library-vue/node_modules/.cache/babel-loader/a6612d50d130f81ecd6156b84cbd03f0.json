{"remainingRequest":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\router\\permission.js","dependencies":[{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\src\\router\\permission.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\babel.config.js","mtime":1654054537000},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\unplugin\\dist\\webpack\\loaders\\transform.js","mtime":1749726393299},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1749726397539},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1749726398436},{"path":"D:\\桌面\\前端交互\\final\\LibraryManagementSystem-master\\Library-vue\\node_modules\\eslint-loader\\index.js","mtime":1749726396308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovXHU2ODRDXHU5NzYyL1x1NTI0RFx1N0FFRlx1NEVBNFx1NEU5Mi9maW5hbC9MaWJyYXJ5TWFuYWdlbWVudFN5c3RlbS1tYXN0ZXIvTGlicmFyeS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDovXHU2ODRDXHU5NzYyL1x1NTI0RFx1N0FFRlx1NEVBNFx1NEU5Mi9maW5hbC9MaWJyYXJ5TWFuYWdlbWVudFN5c3RlbS1tYXN0ZXIvTGlicmFyeS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7CmltcG9ydCByb3V0ZXIgZnJvbSAiQC9yb3V0ZXIvaW5kZXgiOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gIkAvdXRpbHMvYXV0aCI7CmltcG9ydCB7IHVzZVVzZXJJbmZvU3RvcmUgfSBmcm9tICJAL3N0b3JlL3VzZVVzZXJJbmZvU3RvcmUiOyAvLyDkuI3pnIDopoHph43lrprlkJHnmoTnmb3lkI3ljZUKCnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbiddOwpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBVc2VySW5mb1N0b3JlLCBfVXNlckluZm9TdG9yZTsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOwogICAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CgogICAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgVXNlckluZm9TdG9yZSA9IHVzZVVzZXJJbmZvU3RvcmUoKTsKCiAgICAgICAgICAgIGlmICghVXNlckluZm9TdG9yZS5oYXNHZXRVc2VySW5mbykgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5bey57uP6I635Y+W5LqG55So5oi355qE5p2D6ZmQ5L+h5oGv77yM5L2G5piv6Lev55Sx5LiN5a2Y5Zyo55qE5oOF5Ya15LiL6Lez6L2s5Yiw6aaW6aG1CiAgICAgICAgICAgIGlmICh0by5tYXRjaGVkLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8g5q2j5bi45oOF5Ya15LiL55u05o6l6Lez6L2sCiAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMzsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICByZXR1cm4gVXNlckluZm9TdG9yZS5nZXRVc2VySW5mbygpOwoKICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIG5leHQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0byksIHt9LCB7CiAgICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE5OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEzKTsKICAgICAgICAgICAgLy9UT0RPIOiOt+WPlueUqOaIt+S/oeaBr+Wksei0peWImemHjee9rueUqOaIt+S/oeaBrwogICAgICAgICAgICBVc2VySW5mb1N0b3JlLnJlc2V0VXNlckluZm8oKTsKICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgcGF0aDogIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKCiAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjc7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgIC8vIOayoeaciXRva2VuCiAgICAgICAgICAgIGlmICh3aGl0ZUxpc3QuaW5kZXhPZih0by5wYXRoKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAvLyBpbiB0aGUgZnJlZSBsb2dpbiB3aGl0ZWxpc3QsIGdvIGRpcmVjdGx5CiAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIG90aGVyIHBhZ2VzIHRoYXQgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgYXJlIHJlZGlyZWN0ZWQgdG8gdGhlIGxvZ2luIHBhZ2UuCiAgICAgICAgICAgICAgX1VzZXJJbmZvU3RvcmUgPSB1c2VVc2VySW5mb1N0b3JlKCk7CgogICAgICAgICAgICAgIF9Vc2VySW5mb1N0b3JlLnJlc2V0VXNlckluZm8oKTsKCiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBwYXRoOiAiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxMywgMTldXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICAvLyBmaW5pc2ggcHJvZ3Jlc3MgYmFyCiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"names":["NProgress","router","getToken","useUserInfoStore","whiteList","beforeEach","to","from","next","start","hasToken","path","done","UserInfoStore","hasGetUserInfo","matched","length","getUserInfo","replace","resetUserInfo","indexOf","afterEach"],"sources":["D:/桌面/前端交互/final/LibraryManagementSystem-master/Library-vue/src/router/permission.js"],"sourcesContent":["import NProgress from 'nprogress'\nimport 'nprogress/nprogress.css'\nimport router from \"@/router/index\";\nimport {getToken} from \"@/utils/auth\";\nimport {useUserInfoStore} from \"@/store/useUserInfoStore\";\n\n// 不需要重定向的白名单\nconst whiteList = ['/login']\n\nrouter.beforeEach(async (to,from,next)=>{\n  NProgress.start()\n  const hasToken = getToken()\n  if(hasToken){\n    if(to.path === '/login'){\n      next({path: '/'})\n      NProgress.done()\n    }else{\n      const UserInfoStore = useUserInfoStore()\n      if(UserInfoStore.hasGetUserInfo){\n        // 已经获取了用户的权限信息，但是路由不存在的情况下跳转到首页\n        if(to.matched.length === 0){\n          next({path: '/'})\n        }else {\n          // 正常情况下直接跳转\n          next()\n        }\n      }else{\n        try {\n          // TODO 获取用户信息和权限,动态生成了路由\n          await UserInfoStore.getUserInfo()\n          next({ ...to, replace: true })\n        }catch (error){\n          //TODO 获取用户信息失败则重置用户信息\n          UserInfoStore.resetUserInfo()\n          next({path: `/login?redirect=${to.path}`})\n          NProgress.done()\n        }\n      }\n    }\n  }else{\n    // 没有token\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      const UserInfoStore = useUserInfoStore()\n      UserInfoStore.resetUserInfo()\n      next({path: `/login?redirect=${to.path}`})\n      NProgress.done()\n    }\n  }\n})\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n"],"mappings":";;;AAAA,OAAOA,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAAQC,QAAR,QAAuB,cAAvB;AACA,SAAQC,gBAAR,QAA+B,0BAA/B,C,CAEA;;AACA,IAAMC,SAAS,GAAG,CAAC,QAAD,CAAlB;AAEAH,MAAM,CAACI,UAAP;EAAA,mEAAkB,iBAAOC,EAAP,EAAUC,IAAV,EAAeC,IAAf;IAAA;;IAAA;MAAA;QAAA;UAAA;YAChBR,SAAS,CAACS,KAAV;YACMC,QAFU,GAECR,QAAQ,EAFT;;YAAA,KAGbQ,QAHa;cAAA;cAAA;YAAA;;YAAA,MAIXJ,EAAE,CAACK,IAAH,KAAY,QAJD;cAAA;cAAA;YAAA;;YAKZH,IAAI,CAAC;cAACG,IAAI,EAAE;YAAP,CAAD,CAAJ;YACAX,SAAS,CAACY,IAAV;YANY;YAAA;;UAAA;YAQNC,aARM,GAQUV,gBAAgB,EAR1B;;YAAA,KASTU,aAAa,CAACC,cATL;cAAA;cAAA;YAAA;;YAUV;YACA,IAAGR,EAAE,CAACS,OAAH,CAAWC,MAAX,KAAsB,CAAzB,EAA2B;cACzBR,IAAI,CAAC;gBAACG,IAAI,EAAE;cAAP,CAAD,CAAJ;YACD,CAFD,MAEM;cACJ;cACAH,IAAI;YACL;;YAhBS;YAAA;;UAAA;YAAA;YAAA;YAAA,OAoBFK,aAAa,CAACI,WAAd,EApBE;;UAAA;YAqBRT,IAAI,iCAAMF,EAAN;cAAUY,OAAO,EAAE;YAAnB,GAAJ;YArBQ;YAAA;;UAAA;YAAA;YAAA;YAuBR;YACAL,aAAa,CAACM,aAAd;YACAX,IAAI,CAAC;cAACG,IAAI,4BAAqBL,EAAE,CAACK,IAAxB;YAAL,CAAD,CAAJ;YACAX,SAAS,CAACY,IAAV;;UA1BQ;YAAA;YAAA;;UAAA;YA+Bd;YACA,IAAIR,SAAS,CAACgB,OAAV,CAAkBd,EAAE,CAACK,IAArB,MAA+B,CAAC,CAApC,EAAuC;cACrC;cACAH,IAAI;YACL,CAHD,MAGO;cACL;cACMK,cAFD,GAEiBV,gBAAgB,EAFjC;;cAGLU,cAAa,CAACM,aAAd;;cACAX,IAAI,CAAC;gBAACG,IAAI,4BAAqBL,EAAE,CAACK,IAAxB;cAAL,CAAD,CAAJ;cACAX,SAAS,CAACY,IAAV;YACD;;UAzCa;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EAAA;IAAA;EAAA;AAAA;AA4CAX,MAAM,CAACoB,SAAP,CAAiB,YAAM;EACrB;EACArB,SAAS,CAACY,IAAV;AACD,CAHD"}]}